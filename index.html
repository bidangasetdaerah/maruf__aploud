<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Integrasi Apps Script</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-center p-6">

<h1 class="text-3xl font-bold mb-6">Data dari Apps Script</h1>

<div id="data-container" class="w-full max-w-xl bg-white shadow-md rounded p-4">
  Memuat data...
</div>

<button id="refreshBtn" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
  Muat Ulang
</button>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwm5bguSuROeI7OUm49xCOzkSpbq5lXes8C5-Bn2pUNppv-yE6sA_K1vjePRJ99SxoMww/exec";

async function loadData() {
  const container = document.getElementById("data-container");
  container.innerHTML = "Memuat data...";
  try {
    const response = await fetch(SCRIPT_URL);
    if (!response.ok) throw new Error("Gagal memuat data");
    const data = await response.json(); // Asumsikan Apps Script mengembalikan JSON
    // Tampilkan data dalam list
    container.innerHTML = `<ul class="list-disc pl-5">
      ${data.map(item => `<li>${item}</li>`).join("")}
    </ul>`;
  } catch (err) {
    container.innerHTML = `<span class="text-red-500">Error: ${err.message}</span>`;
  }
}

// Muat data saat halaman dibuka
loadData();

// Tombol refresh
document.getElementById("refreshBtn").addEventListener("click", loadData);
</script>

</body>
</html>
